# 多模态功能使用示例

## 概述

本文档提供了 Vertex Workflow Chat 应用多模态功能的具体使用示例，帮助用户快速上手图片分析和文本+图片对话功能。

## 快速开始

### 1. 启用多模态功能

确保在配置文件中启用 OpenRouter 的 Gemini 模型：

```yaml
llm:
  openrouter:
    sk: ${llm.openrouter.sk:your-openrouter-api-key}
    enabled: true
    model-name: google/gemini-2.5-pro
```

### 2. 启动应用

```bash
# 启动支持多模态的聊天应用
uv run python vertex_flow/src/workflow_app.py --port 7860
```

## 使用示例

### 示例1：图片内容分析

**场景**：分析上传的图片内容

**操作步骤**：
1. 在聊天界面点击"上传图片"按钮
2. 选择一张图片文件
3. 在文本框中输入："这张图片里有什么？"
4. 点击发送

**预期结果**：
```
AI回复：这张图片展示了一个现代化的办公环境，包含：
- 一张整洁的办公桌
- 一台笔记本电脑
- 一杯咖啡
- 一些办公用品
整体氛围看起来专业而舒适。
```

### 示例2：图表数据分析

**场景**：分析数据图表

**操作步骤**：
1. 上传一张包含图表的图片
2. 输入问题："分析这个图表的数据趋势"
3. 发送消息

**预期结果**：
```
AI回复：根据图表显示，数据呈现以下趋势：
- 销售额在过去6个月中持续增长
- 增长率在3-4月达到峰值
- 5-6月增长趋于平稳
- 总体趋势向好，建议继续保持当前策略。
```

### 示例3：产品识别和描述

**场景**：识别产品并分析特点

**操作步骤**：
1. 上传产品照片
2. 输入："这是什么产品？有什么特点？"
3. 发送消息

**预期结果**：
```
AI回复：这是一个智能手机，具有以下特点：
- 大屏幕设计，提供良好的视觉体验
- 多摄像头系统，支持专业摄影
- 金属边框，质感优良
- 指纹识别功能
- 整体设计简洁现代
```

### 示例4：图片URL分析

**场景**：使用网络图片链接

**操作步骤**：
1. 在"图片URL"输入框中粘贴图片链接
2. 输入问题："分析这张图片的风格"
3. 发送消息

**预期结果**：
```
AI回复：这张图片采用了极简主义风格：
- 构图简洁，主体突出
- 色彩搭配和谐
- 光影效果自然
- 整体氛围宁静优雅
```

## 高级用法

### 混合对话示例

**场景**：结合文本和图片进行复杂分析

**操作步骤**：
1. 上传一张风景照片
2. 输入："这是一个旅游景点吗？如果是，推荐什么季节去？"
3. 发送消息

**预期结果**：
```
AI回复：根据图片分析，这确实是一个美丽的旅游景点：
- 看起来像是一个山区景点
- 植被茂密，环境优美
- 有清澈的水体和岩石景观

推荐季节：
- 春季：花开时节，景色宜人
- 秋季：色彩丰富，适合摄影
- 避开雨季，确保安全
```

### 技术文档分析

**场景**：分析技术图表或截图

**操作步骤**：
1. 上传技术文档截图
2. 输入："解释这个技术架构图"
3. 发送消息

**预期结果**：
```
AI回复：这是一个微服务架构图，包含以下组件：
- API网关：统一入口
- 用户服务：处理用户认证
- 订单服务：管理订单流程
- 支付服务：处理支付逻辑
- 数据库：数据存储层

架构特点：
- 服务解耦，独立部署
- 高可用性和可扩展性
- 支持不同技术栈
```

## 最佳实践

### 图片质量建议

1. **分辨率**：使用清晰、分辨率适中的图片
2. **格式**：优先使用JPG或PNG格式
3. **大小**：单个图片建议不超过10MB
4. **内容**：确保图片内容清晰可见

### 提问技巧

1. **具体问题**：提出明确、具体的问题
2. **上下文结合**：将图片内容与文本问题结合
3. **分步分析**：复杂图片可以分步骤提问

### 错误处理

1. **不支持的图片源**
   - Discord图片链接可能不被支持
   - 建议下载后重新上传

2. **网络问题**
   - 确保图片URL可公开访问
   - 检查网络连接稳定性

## 常见问题解答

### Q: 为什么我的图片无法分析？
A: 可能的原因：
- 图片格式不支持
- 图片文件损坏
- 网络连接问题
- API密钥配置错误

### Q: 可以同时分析多张图片吗？
A: 当前版本支持单张图片，多张图片功能正在开发中。

### Q: 多模态功能会影响文本对话吗？
A: 不会，多模态功能是增强功能，文本对话完全正常。

### Q: 支持哪些图片格式？
A: 支持JPG、PNG、GIF、WebP等常见格式。

## 技术细节

### 消息格式

多模态消息使用OpenAI兼容格式：

```python
{
    "role": "user",
    "content": [
        {"type": "text", "text": "问题描述"},
        {"type": "image_url", "image_url": {"url": "base64_data"}}
    ]
}
```

### 图片处理流程

1. 用户上传图片 → Base64编码
2. 组装多模态消息
3. 发送到OpenRouter API
4. Gemini模型分析
5. 返回分析结果

### 错误处理机制

- 自动检测不支持的图片源
- 友好的错误提示
- 详细的日志记录

## 总结

多模态功能为 Vertex Workflow Chat 应用带来了强大的图像理解能力，使用户能够通过图片和文本的组合与AI进行更自然、更丰富的交互。通过合理使用和正确配置，多模态功能将大大提升用户体验和应用价值。 