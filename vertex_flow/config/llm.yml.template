# Vertex Flow 统一配置模板
# 集成了LLM、MCP、向量存储、网络搜索等所有功能的配置
# 通过docker env可以注入相关的配置，作为修改值
# 例如llm.deepseek.sk，则通过llm_deepseek_sk环境变量
# 在docker启动时设置-e llm_deepseek_sk=?
#
# 本地模型支持（Ollama）:
# 1. 安装Ollama: https://ollama.com/download
# 2. 启动服务: ollama serve
# 3. 拉取模型: ollama pull qwen:7b
# 4. 在应用中切换到ollama提供商

# ============================================================================
# 大语言模型配置 (LLM Configuration)
# ============================================================================
llm:
  deepseek:
    sk: ${llm.deepseek.sk:-YOUR_DEEPSEEK_API_KEY}
    enabled: ${llm.deepseek.enabled:false}
    base_url: ${llm.deepseek.base_url:https://api.deepseek.com}
    models:
      - name: deepseek-chat
        enabled: ${llm.deepseek.models.deepseek_chat.enabled:false}
      - name: deepseek-reason
        enabled: ${llm.deepseek.models.deepseek_coder.enabled:false}
  tongyi:
    sk: ${llm.tongyi.sk:-YOUR_TONGYI_API_KEY}
    enabled: ${llm.tongyi.enabled:false}
    base_url: ${llm.tongyi.base_url:https://dashscope.aliyuncs.com/compatible-mode/v1}
    models:
      - name: qwen-vl-max
        enabled: ${llm.tongyi.models.qwen_vl_max.enabled:false}
      - name: qwen-max
        enabled: ${llm.tongyi.models.qwen_max.enabled:true}
      - name: qwen-plus
        enabled: ${llm.tongyi.models.qwen_plus.enabled:false}
      - name: qwen-turbo
        enabled: ${llm.tongyi.models.qwen_turbo.enabled:false}
  openrouter:
    sk: ${llm.openrouter.sk:-YOUR_OPENROUTER_API_KEY}
    enabled: ${llm.openrouter.enabled:false}
    base_url: ${llm.openrouter.base_url:https://openrouter.ai/api/v1}
    models:
      - name: deepseek/deepseek-chat-v3-0324:free
        enabled: ${llm.openrouter.models.deepseek_chat_v3_0324.enabled:false}
      - name: deepseek/deepseek-r1-0528:free
        enabled: ${llm.openrouter.models.deepseek_r1_0528.enabled:true}
      - name: google/gemini-2.5-pro
        enabled: ${llm.openrouter.models.gemini_2_5_pro.enabled:true}
      - name: anthropic/claude-3.5-sonnet
        enabled: ${llm.openrouter.models.claude_3_5_sonnet.enabled:false}
      - name: openai/gpt-4o
        enabled: ${llm.openrouter.models.gpt_4o.enabled:false}
      - name: openai/gpt-oss
        enabled: ${llm.openrouter.models.gpt_oss.enabled:false}
  openai:
    sk: ${llm.openai.sk:-YOUR_OPENAI_API_KEY}
    enabled: ${llm.openai.enabled:false}
    base_url: ${llm.openai.base_url:https://api.openai.com/v1}
    models:
      - name: gpt-4o-mini
        enabled: ${llm.openai.models.gpt_4o_mini.enabled:true}
      - name: gpt-4.1
        enabled: ${llm.openai.models.gpt_4_1.enabled:false}
  ollama:
    sk: ${llm.ollama.sk:-ollama-local}          # 本地模型不需要真实API key，使用占位符
    enabled: ${llm.ollama.enabled:-false}       # 默认不启用，需要手动切换
    base-url: ${llm.ollama.base_url:http://localhost:11434}  # Ollama服务地址
    models:
      - name: qwen:7b
        enabled: ${llm.ollama.models.qwen_7b.enabled:true}
      - name: llama3:8b
        enabled: ${llm.ollama.models.llama3_8b.enabled:false}
      - name: mistral:7b
        enabled: ${llm.ollama.models.mistral_7b.enabled:false}
  doubao:
    sk: ${llm.doubao.sk:-YOUR_DOUBAO_API_KEY}
    enabled: ${llm.doubao.enabled:-false}
    base_url: ${llm.doubao.base_url:https://ark.cn-beijing.volces.com/api/v3}
    models:
      - name: doubao-seed-1.6-250615
        enabled: ${llm.doubao.models.doubao_seed_1_6_250615.enabled:true}
      - name: doubao-seed-1.6-thinking-250615
        enabled: ${llm.doubao.models.doubao_seed_1_6_thinking_250615.enabled:false}
      - name: doubao-seed-1.6-flash-250615
        enabled: ${llm.doubao.models.doubao_seed_1_6_flash_250615.enabled:false}
  
  # 其他自定义LLM提供商配置
  # 支持每个模型单独配置provider、model name和base_url
  # 适用于自定义API端点、私有部署模型等场景
  other:
    enabled: ${llm.other.enabled:-false}  # 默认不启用
    models:
      # 示例：SiliconFlow Qwen/QwQ-32B模型
      - name: Qwen/QwQ-32B
        enabled: ${llm.other.models.qwen_qwq_32b.enabled:false}
        provider: "siliconflow"
        base_url: ${llm.other.qwen_qwq_32b.base_url:-https://api.siliconflow.cn/v1}
        sk: ${llm.other.qwen_qwq_32b.sk:-YOUR_SILICONFLOW_API_KEY}
      
      # 示例：自定义OpenAI兼容API
      - name: custom-model-1
        enabled: ${llm.other.models.custom_model_1.enabled:false}
        provider: "custom-openai"
        base_url: ${llm.other.custom_model_1.base_url:-https://your-custom-api.com/v1}
        sk: ${llm.other.custom_model_1.sk:-YOUR_CUSTOM_API_KEY}
      
      # 示例：私有部署的模型
      - name: private-llama
        enabled: ${llm.other.models.private_llama.enabled:false}
        provider: "private-deployment"
        base_url: ${llm.other.private_llama.base_url:-http://localhost:8000/v1}
        sk: ${llm.other.private_llama.sk:-your-private-key}
      
      # 示例：第三方API服务
      - name: third-party-model
        enabled: ${llm.other.models.third_party_model.enabled:false}
        provider: "third-party"
        base_url: ${llm.other.third_party_model.base_url:-https://api.thirdparty.com/v1}
        sk: ${llm.other.third_party_model.sk:-YOUR_THIRD_PARTY_API_KEY}
      
      # 示例：本地部署的模型服务
      - name: local-model
        enabled: ${llm.other.models.local_model.enabled:false}
        provider: "local"
        base_url: ${llm.other.local_model.base_url:-http://127.0.0.1:8080/v1}
        sk: ${llm.other.local_model.sk:-local-key}

web-search:
  # Bocha AI搜索服务 - 高质量AI总结，支持日期过滤
  bocha:
    sk: ${web-search.bocha.sk:-YOUR_BOCHA_API_KEY}
    enabled: false  # 需要API密钥，提供最佳搜索体验
  
  # DuckDuckGo搜索服务 - 免费即时答案，无需API密钥
  duckduckgo:
    enabled: true  # 默认启用，作为免费备选方案
  
  # SerpAPI搜索服务 - Google搜索结果，免费层每月100次
  serpapi:
    api_key: ${web-search.serpapi.api_key:-YOUR_SERPAPI_API_KEY}
    enabled: false  # 需要API密钥，提供Google搜索结果
  
  # SearchAPI.io搜索服务 - 多搜索引擎支持，免费层每月100次
  searchapi:
    api_key: ${web-search.searchapi.api_key:-YOUR_SEARCHAPI_API_KEY}
    enabled: false  # 需要API密钥，支持多种搜索引擎
  
  # Brave Search API服务 - 隐私保护的搜索引擎，需要API密钥
  brave:
    api_key: ${web-search.brave.api_key:-YOUR_BRAVE_API_KEY}
    enabled: false  # 需要API密钥，提供隐私保护的搜索结果
  
  # 注意：以上搜索服务按优先级排序，系统会自动选择第一个启用且配置正确的服务
  # 建议配置：启用Bocha AI（付费，最佳体验）+ DuckDuckGo（免费备选）
  
  # 已废弃的配置（保留以兼容旧版本）
  bing:
    sk: ${web-search.bing.sk:-YOUR_BING_API_KEY}
    enabled: false

# 金融工具配置
finance:
  alpha-vantage:
    api-key: ${finance.alpha-vantage.api-key:-YOUR_ALPHA_VANTAGE_API_KEY}
    enabled: false
  finnhub:
    api-key: ${finance.finnhub.api-key:-YOUR_FINNHUB_API_KEY}
    enabled: false
  yahoo-finance:
    enabled: true

workflow:
  dify:
    root-path: config/
    instances:

web:
  port: 8999
  host: 0.0.0.0
  workers: 8

# 向量存储配置（支持本地和云端）
vector:
  # 本地向量存储配置
  local:
    enabled: true  # 默认启用本地向量存储
    dimension: 384  # 向量维度
    index_name: "default"  # 索引名称
    persist_dir: null  # 持久化目录，null表示使用默认目录 (~/.vertex_flow/vector_db)
  
  # DashVector云端配置
  dashvector:
    enabled: false  # 默认不启用云端
    api-key: ${vector.dashvector.api_key:-YOUR_DASHVECTOR_API_KEY}
    endpoint: ${vector.dashvector.endpoint:-YOUR_DASHVECTOR_ENDPOINT}
    cluster: ${vector.dashvector.cluster:-vertex-vector}
    collection: ${vector.dashvector.collection:-YOUR_COLLECTION_NAME}
    image-collection: ${vector.dashvector.image_collection:-YOUR_IMAGE_COLLECTION_NAME}

# 嵌入模型配置（支持本地和云端）
embedding:
  # 本地嵌入模型配置
  local:
    enabled: true  # 默认启用本地嵌入
    model_name: "all-MiniLM-L6-v2"  # 本地嵌入模型名称
    dimension: 384  # 向量维度
    use_mirror: true  # 是否使用国内镜像源（默认true）
    mirror_url: "https://hf-mirror.com"  # 镜像源URL
  
  # DashScope云端配置
  dashscope:
    enabled: false  # 默认不启用云端
    endpoint: ${embedding.dashscope.endpoint:-default}
    api-key: ${embedding.dashscope.api_key:-YOUR_DASHSCOPE_API_KEY}
    model-name: ${embedding.dashscope.model_name:-text-embedding-v1}
  
  # BCE云端配置
  bce:
    enabled: false  # 默认不启用云端
    api-key: ${embedding.bce.api_key:-YOUR_BCE_API_KEY}
    endpoint: ${embedding.bce.endpoint:-https://api.siliconflow.cn/v1/embeddings}
    model-name: ${embedding.bce.model_name:-netease-youdao/bce-embedding-base_v1}
    dimension: 768  # BCE 嵌入模型维度

# 重排序配置
rerank:
  # 本地重排序配置
  local:
    enabled: false  # 默认不启用本地重排序
    method: "keyword"  # 重排序方法：keyword, semantic
  
  # BCE云端重排序配置
  bce:
    enabled: false  # 默认不启用云端重排序
    api-key: ${rerank.bce.api_key:-YOUR_BCE_RERANK_API_KEY}
    endpoint: ${rerank.bce.endpoint:-https://api.siliconflow.cn/v1/rerank}
    model-name: ${rerank.bce.model_name:-netease-youdao/bce-reranker-base_v1}

# 文档处理配置
document:
  chunk_size: 512  # 文档分块大小，与 BCE 嵌入 API 的 token 限制一致
  chunk_overlap: 128  # 分块重叠大小
  supported_formats: ["txt", "md", "pdf", "docx"]  # 支持的文档格式

# 检索配置
retrieval:
  top_k: 3  # 检索的文档数量
  similarity_threshold: 0.7  # 相似度阈值
  rerank: false  # 是否启用重排序

